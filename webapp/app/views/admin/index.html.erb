<table class="table table-hover table-condensed">
  <thead>
    <tr>
      <th>Name</th>
      <th>Kind</th>
      <th colspan="3">Actions</th>
    </tr>
  </thead>

  <tbody id="pages-table">
    <% @pages.each do |page| %>
    <tr>
      <td><%= page.name %></td>
      <td><%= page.kind %></td>
      <td><%= link_to 'Show', page %></td>
      <td>
        <% if page.active %>
        <button data-page-id="<%= page.id %>" class="btn btn-warning-outline deactivate-page-btn">Deactivate</button>
      <% else %>
        <button id="state-page" data-page-id="<%= page.id %>" class="btn btn-success-outline activate-page-btn">Activate</button>
        <% end %>
      </td>
      <td>
        <button id="delete-page-<%= page.id %>" class="btn btn-danger-outline">Delete</button>
      </td>
    </tr>
    <% end %>
  </tbody>
</table>

<script type="text/javascript">

  $("#pages-table").on("click", ".deactivate-page-btn", function () {
    var $this = $(this);
    var pageid = $this.attr("data-page-id");

    $.post("/admin/make_page_inactive", {pageid: pageid}).done(function () {
      $this.text("Activate").removeClass("btn-warning-outline deactivate-page-btn").addClass("btn-success-outline activate-page-btn");
    }).fail(function (e) {
      console.log("errore" + e);
    })
  });

  $("#pages-table").on("click", ".activate-page-btn", function () {
    var $this = $(this);
    var pageid = $this.attr("data-page-id");

    $.post("/admin/make_page_active", {pageid: pageid}).done(function () {
      $this.text("Deactivate").removeClass("btn-success-outline activate-page-btn").addClass("btn-warning-outline deactivate-page-btn");
    }).fail(function (e) {
      console.log("errore" + e);
    })
  });
</script>
