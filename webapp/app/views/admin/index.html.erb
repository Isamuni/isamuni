<% if !@pages.empty? %>

<table class="table table-hover table-condensed">
  <thead>
    <tr>
      <th>Name</th>
      <th>Kind</th>
      <th colspan="3">Actions</th>
    </tr>
  </thead>

  <tbody>
    <% @pages.each do |page| %>
      <tr>
        <td><%= page.name %></td>
        <td><%= page.kind %></td>
        <td><%= link_to 'Show', page %></td>
        <td>
          <% if page.active %>
            <button id="state-page-<%= page.id %>" class="btn btn-warning-outline">Deactivate</button>
          <% else %>
            <button id="state-page-<%= page.id %>" class="btn btn-success-outline">Activate</button>
          <% end %>
        </td>
        <td>
          <button id="delete-page-<%= page.id %>" class="btn btn-danger-outline">Delete</button>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<% else %>
<p>Sorry, but you do not have permissions to access this page :( </p>
<% end %>

<script type="text/javascript">

$("button[id^='state-page']").click(function() {
  var $this = $(this);

  $.ajax({
    url: "/admin/page_state", 
    dataType: "json", 
    async: true,
    data: {'post_id' : $this.attr('id').substring(10)}
  }).done(function() {
    if($this.hasClass('btn-success-outline')){
      $this.text('Deactivate');         
    } else {
      $this.text('Activate');
    }

    $this.toggleClass("btn btn-success-outline").toggleClass("btn btn-danger-outline");
  });

})
</script>